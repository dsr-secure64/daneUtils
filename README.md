# DANE utilities

 * [smimeaUtil](#smimea-utility)
 * [tlsaUtil](#tlsa-utility)

## Build dependencies

The smimea-util is designed for testing of SMIMEA records generated by
miekg/dns go package. To build the file assumes the following branch:

remotes/origin/smimea                  f13c21d Fix for miekg/dns issue #289: support the SMIMEA record

Until such time as the changes are added to master development branch.

## SMIMEA Utility

The smimea-util go program generates an SMIMEA record from the following:

```
1) An Email Certificate  
2) A user name  
3) A user domain
```

The utility further allows any valid value for the usage, selector,
and matching type fields to support the desired formating of the
SMIMEA RDATA section.

### Usage

```
Usage of ./smimea-util:  
  -certPEMFile string  
    certificate file in PEM format  
  -matchType int  
     Dane matching type field  
  -selector int  
    DANE certificate selector field
  -usage int
    DANE certificate usage field
  -userdomain string
    email user domain association
  -username string
    email user name
```

### Example Output
```
dsr@enigma:~/go/src/dsr/certs-test$ ./smimea-util -username=bilbo.baggins -userdomain=theshire.com -certPEMFile=certs/bbaggins.pem -usage=3 -selector=0 -matchType=0

SMIMEA record for bilbo.baggins@theshire.com

2e85e1db3e62be6ea76d855de96d8dce26e29b8323be936b13f71bbb._smimecert.theshire.com	3600	IN	SMIMEA	3 0 0 3082053c30820324020101300d06092a864886f70d01010b05003057310b3009060355040613025553310b300906035504080c02434f310d300b06035504070c04464f434f31133011060355040a0c0a536175726f6e20496e633117301506035504030c0e7777772e736175726f6e2e636f6d301e170d3136313030393033343034375a170d3137313030393033343034375a3071310b3009060355040613025553310b300906035504080c02434f310d300b06035504070c04464f434f3121301f060355040a0c18496e7465726e6574205769646769747320507479204c74643123302106035504030c1a62696c626f2e62616767696e734074686573686972652e636f6d30820222300d06092a864886f70d01010105000382020f003082020a0282020100d19f6e2462b3e216ff3f8dcb263dbd325b5a23df522ebd9f6eb72a9768c3413f2829c5c93d5fae3ac7d1db377a79d457172661e16efe0e135b39b2c60306a1d2e4a934c6928d4e25d3fabf2d5a11291f75059951b5052c6f0807edeae33cc62f53c2e14a1016005c4a0a9850c357b87ef27bcf05f1c77e59066f6fb07fd3ec27e94ecc7951956099ef81f0484ff4529b609f2f4287cd29db5c14e710aef6219308b27649e5862b1a1318ff51ca8b8ea09b09e48a56b47398495840af93b7e363078c1374677f7a2df19f6aceb9a09ae2f1f07ed347d24d48988db606c52e9366483f1963086af2a077fe7d2220c66196dcde4e18e214199f8f6c5d48c3cd9892d513e68025b061c2822c773fa6a5c6a52d92ea790c65c4b94c6726825adb5784ca1963383152853bab0503d1057783125c5ca8fbff1f48364e60d70f612a0fb6229fc2b297a4ea0f50483765bb3d6ab2830887a96092810d35a2d8736402845f8c9f52aa4ac20f286f9a04d99bf2968e331242904441b1be7c91beec49dbd3c95b38d4ef4912f534f7bfe8cf758378f2b8e4a91dc6c51ab37c072e05640f27d292a10985ba9971e67809018eb02aa759529007d0b16951508c2ed47d6553bac0f99eccc886354d4cd487bdb8ca640085f51e4608b3e12a8f0b824d88531e84c3b6c52e43999828d3c220af678cdb3d3b32a889cc8b2db47e70c23c517d8554510203010001300d06092a864886f70d01010b05000382020100a8cfb43cf39eea17c85797f9111ecb74907f5e102e1f8799043b53d8a94a1d0dde3f045fcfd09a2910a1db318917e04b1e22de316e3008e9f12ab7f7e259a1dc02334118de9f5897e02df0a4f024cb8ec4df9a030d83820c464638e4180d95a989a209cab79bb469ca76f2cd327691e86776bb76834560ec9c66a1a572367b7164b96fa3bfc8999ddc57b34113291fd43ae401be4f554820c7dd543ddedcdeb6b96a4bdb8fc5895a89e8cbb5cfb58ea15bb72b307b0915840cf75cad4954b50229c117ca4c2cd4ca4e57b7a46c60131d69b41151c8af2bc0b7fbbe2f4d6827c6dedd2cf0f334ce790220a5d63f4cc729cba9953a8b9fcda3b954fcb76e2379d4933458cdf0ec3a04470e39c624a76a6bd74c33c219c25bb98520767d9a6bb702eaf8ce4a86f8689e32cf0b373e166ee9f09ff70151b99734a1ba1d91e4899fa8f8f7ec0d3778e61091db212e921ac5232143443ccc62611d59efce41f2921013ccc9157b3da25ccec0999513afd18a641f34cf46ee31485f4a8ccd8dab2eaa4271466c01b5e7f4151af4e80917f665415d87435933e2c6296f06df33735cb706045b632cb1889bc5d561b67592199eb40804a3b49dfe94154256481565d747f7b09ea97ed375915c292b5c6b440f5eb6a074d78843ac9bf015a1cccdd78d67462b182bdfb53bc7f43896fafbe06cc4056f6be86364add6d9e823fc3a79b2f5b6
```

### SMIME Certificate

[SMIME Certificate](certs/bbaggins_cert.txt)

## TLSA Utility

The tlsa-util go program generates a TLSA record from the following:

```
1) Fully qualitifed domain name, e. g. www.example.com
2) A certificate for www.example.com
```

The utility further allows any valid value for the usage, selector,
and matching type fields to support the desired formating of the
TLSA RDATA section.

### Usage
```
Usage of ./tlsa-util:
  -certPEMFile string
       TLS certificate file iQn PEM format
  -fqdn string
       fully qualified domain name
  -matchType int
       Dane matching type field
  -network string
       network protocol: tcp, udp
  -selector int
       DANE certificate selector field
  -service string
       /etc/services defined application
  -usage int
       DANE certificate usage field
```

### Example Output

```
> ./tlsa-util -certPEMFile=certs/enigma-tls.pem -fqdn enigma.i.secure64.com -network tcp -service https -usage=3 -selector=0 -matchType=0

dsr@enigma:~/go/src/github.com/dsr-secure64/daneUtils$ ./tlsa-util -certPEMFile=certs/enigma-tls.pem -fqdn enigma.i.secure64.com -network tcp -service https -usage=3 -selector=0 -matchType=0
TLSA name: _443._tcp.enigma.i.secure64.com.
TLSA record: _443._tcp.enigma.i.secure64.com.	3600	IN	TLSA	3 0 0 308205453082032d020103300d06092a864886f70d01010b0500306d3111300f060355040a13085365637572653634311530130603550407130c466f727420436f6c6c696e73310b300906035504081302434f310b3009060355040613025553312730250603550403131e536563757265363420436572746966696361746520417574686f72697479301e170d3136313031323135343834395a170d3236313031303135343834395a30643111300f060355040a13085365637572653634311530130603550407130c466f727420436f6c6c696e73310b300906035504081302434f310b3009060355040613025553311e301c06035504031315656e69676d612e692e73656375726536342e636f6d30820222300d06092a864886f70d01010105000382020f003082020a02820201009856dec13c10400d79a2dc8ecf0ab2c9846fc87fccd20ccb447ae11cf4b21f9fbc323121f0b7c600026e302794efe61692deb66b2bc41751ddbe7f6433118431240edf7688e400bcc36d97a4808e935c3144c18cc0021eac7724c8db5f30a8643ba4c74e7bb81b799c8d1dcad5f267339cad3b09f9b0f8787a8e79c339cea0ef1ba181fa0e52b82d9b4b1d4bc8c0cacbdc425c1e76c610b9e78e88cc21fc37872f6e090fcb83100d11e446ac15468d3d981e673949251141307e57b20947460f1caee28447433d1e7cb1d1c1ad15d14560068c56707ce568f951b2fab4e3b57a3c0f339d3d6b4abb06e29725a6d11feb6066e32c492d729b7a2abcc5ccae93bd6b6d5c1d384058b95a58e7dc2d3210d81c8c0018b962e6a2ab463f47a977869566e8714cf928590c3d6f760509ae83d94cf0a7d15d0c86904ad52f538b55e98bda5a575810efc8b200fb3a27803d01b6f1f40d38ce80b8fd4b2a6b8472ae83657abf873f723764586a475dca1698c66d95d55434ea215f6de65fc4153b587064db45e80fccba38cd3973138fa50c3fd74ee04a0bf807d746b539e4730cdfa6663df3beb5544544bde77e2a0b28f6985845242910ab0a1867d7a9c2d28a9f05c57a661d1b1fda0c34a0b4ad3c4f1101210198c25a40d1382c956642fcaae1e62dee16d5d40053114a30cb257d7d272351fda208bf04f6f60fa509916128cbd0630203010001300d06092a864886f70d01010b050003820201000552418f12c32ff57958c71f476f3cda02cc13c2cb1569fde983eb493da86554a845b034143d5348ec6a740095314cfb1c3bcc664bd46c646c4f5c0b4c981baa6a79c17dafc69dbbbcc0c6dfc32f960d1ae14789848a22c04c5f326e57c96cbde3a9f7a764416f73aee2aa720c7a492fe4f1ced594a370ffd6be527f0eccabc7baa83cf9a388af18a3004492b1e3f8303c79c36e8d29d1cf6fba42db9a27132d458e30968ff3e221d13b1abeeaaaf7c94f31a86fef54f8fce57070a9e9718c492d0a3c6ffc0e6c4fe7ee0c3bae08c72edf44f9fc6bcdb2c134362bb21bd284bb32356d15ecca0dfb2c2175ef5298b1c633cb184e732597a16bd10e14e90879a35e4cf878e46954c94edccf523ad411b1c04aab6cf1818ef84e4e6fa08f8db870b32f2c772b171d63e31217bed725857786dc8b6d61c0820db39fa71b9da89a1215d0c00ed89735ef463eb0e6de3a3944bed17d2d261d48f6b22e41045086e36b6361267d27d02f24e4e23ee85bf48c681d34175134a561d1870f7c191b22c78b0d33986ca0d45d68aa1ec9a2c640992730218fd32806a6814ef53104960943c1bbf766c0590728aec7307e5a979053f17d9b420fceca0f9ebea2fcff70d1c88c3c17b579b668c71e72d4a55001bbb9c80b5b2f05a35129b8e7769c86b9e74bc9a8f13ec21c3972bc1e2bf235527d6f47938519fa41c702f4e0842a06280b97b4

```
### TLS Certificate

[TLS Certificate](certs/enigma-tls.txt)




